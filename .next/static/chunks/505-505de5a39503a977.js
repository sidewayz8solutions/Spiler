"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[505],{60017:function(e,t,n){n.d(t,{Z:function(){return g}});var a=n(3827),s=n(64090),r=n(8792),i=n(47907),l=n(55138),c=n(3478),o=n(3251),u=n(53404),d=n(89812),h=n(34102),x=n(28042),f=n(58621),m=n(12360);let p=[{href:"/",label:"Dashboard",icon:c.Z},{href:"/dialer",label:"Dialer",icon:o.Z},{href:"/queue",label:"Queue",icon:u.Z},{href:"/donors",label:"Donors",icon:d.Z},{href:"/analytics",label:"Analytics",icon:c.Z},{href:"/settings",label:"Settings",icon:h.Z}];function g(){let e=(0,i.usePathname)(),{user:t,signOut:n}=(0,l.a)(),[c,o]=(0,s.useState)(!1);return(0,a.jsxs)("nav",{className:"bg-spiler-dark/50 backdrop-blur-lg border-b border-indigo-500/10 sticky top-0 z-50",children:[(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,a.jsxs)(r.default,{href:"/",className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCDE"}),(0,a.jsx)("span",{className:"text-xl font-bold text-gradient",children:"Spiler"})]}),(0,a.jsx)("div",{className:"hidden md:flex items-center space-x-1",children:p.map(t=>{let n=t.icon,s=e===t.href;return(0,a.jsxs)(r.default,{href:t.href,className:"\n                    flex items-center space-x-2 px-4 py-2 rounded-lg transition-all\n                    ".concat(s?"bg-indigo-500/20 text-indigo-400":"text-gray-400 hover:text-white hover:bg-white/5","\n                  "),children:[(0,a.jsx)(n,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:t.label})]},t.href)})}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"hidden md:flex items-center space-x-3",children:[(0,a.jsx)("span",{className:"text-sm text-gray-400",children:null==t?void 0:t.email}),(0,a.jsx)("button",{onClick:n,className:"p-2 text-gray-400 hover:text-white transition-colors",title:"Sign out",children:(0,a.jsx)(x.Z,{className:"w-5 h-5"})})]}),(0,a.jsx)("button",{onClick:()=>o(!c),className:"md:hidden p-2 text-gray-400 hover:text-white",children:c?(0,a.jsx)(f.Z,{className:"w-6 h-6"}):(0,a.jsx)(m.Z,{className:"w-6 h-6"})})]})]})}),c&&(0,a.jsx)("div",{className:"md:hidden bg-spiler-dark border-t border-indigo-500/10",children:(0,a.jsxs)("div",{className:"px-4 py-4 space-y-2",children:[p.map(t=>{let n=t.icon,s=e===t.href;return(0,a.jsxs)(r.default,{href:t.href,onClick:()=>o(!1),className:"\n                    flex items-center space-x-3 px-4 py-3 rounded-lg transition-all\n                    ".concat(s?"bg-indigo-500/20 text-indigo-400":"text-gray-400 hover:text-white hover:bg-white/5","\n                  "),children:[(0,a.jsx)(n,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:t.label})]},t.href)}),(0,a.jsxs)("button",{onClick:n,className:"flex items-center space-x-3 px-4 py-3 text-red-400 hover:bg-red-500/10 rounded-lg w-full",children:[(0,a.jsx)(x.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"Sign Out"})]})]})})]})}},8313:function(e,t,n){n.r(t),n.d(t,{Providers:function(){return d},SupabaseContext:function(){return u},useSupabase:function(){return h}});var a=n(3827),s=n(64090),r=n(47907),i=n(58714),l=n(52688),c=n(47082);let o=new l.S,u=(0,s.createContext)(null);function d(e){let{children:t}=e,[n]=(0,s.useState)(()=>(0,i.createClientComponentClient)()),l=(0,r.useRouter)();return(0,s.useEffect)(()=>{let{data:{subscription:e}}=n.auth.onAuthStateChange(e=>{"SIGNED_OUT"===e&&l.push("/auth/login")});return()=>{e.unsubscribe()}},[n,l]),(0,a.jsx)(u.Provider,{value:n,children:(0,a.jsx)(c.aH,{client:o,children:t})})}let h=()=>{let e=(0,s.useContext)(u);if(!e)throw Error("useSupabase must be used within SupabaseProvider");return e}},55138:function(e,t,n){n.d(t,{a:function(){return c}});var a=n(64090),s=n(8313),r=n(22020),i=n(65249);let l=(0,r.Ue)((0,i.tJ)(e=>({user:null,organization:null,teamMember:null,setUser:t=>e({user:t}),setOrganization:t=>e({organization:t}),setTeamMember:t=>e({teamMember:t}),reset:()=>e({user:null,organization:null,teamMember:null})}),{name:"spiler-auth"}));function c(){let e=(0,s.useSupabase)(),{user:t,organization:n,teamMember:r,setUser:i,setOrganization:c,setTeamMember:o,reset:u}=l(),[d,h]=(0,a.useState)(!0);async function x(){try{let{data:{user:t}}=await e.auth.getUser();if(t){i(t);let{data:n}=await e.from("team_members").select("\n            *,\n            organization:organizations(*)\n          ").eq("user_id",t.id).single();n&&(o(n),c(n.organization))}}catch(e){console.error("Error loading user:",e)}finally{h(!1)}}return(0,a.useEffect)(()=>{x();let{data:{subscription:t}}=e.auth.onAuthStateChange(async(e,t)=>{t?await x():u()});return()=>t.unsubscribe()},[]),{user:t,organization:n,teamMember:r,loading:d,signIn:async function(t,n){let{data:a,error:s}=await e.auth.signInWithPassword({email:t,password:n});if(s)throw s;return a},signUp:async function(t,n){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{data:s,error:r}=await e.auth.signUp({email:t,password:n,options:{data:a}});if(r)throw r;return s},signOut:async function(){let{error:t}=await e.auth.signOut();if(t)throw t;u()}}}},45167:function(e,t,n){n.d(t,{q_:function(){return c}});var a=n(64090),s=n(33837);let r="https://azlcbflxczemahcnlrxc.supabase.co",i="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImF6bGNiZmx4Y3plbWFoY25scnhjIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTUxNDkwMTAsImV4cCI6MjA3MDcyNTAxMH0.wPAi2lwNvH828_WjY4swgtF6h3eumzmB3JLzcT7W_cc";if(!r||!i)throw Error("Missing Supabase environment variables");let l=(0,s.createBrowserClient)(r,i);function c(e){let[t,n]=(0,a.useState)([]),[s,r]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{if(!e)return;a();let t=l.channel("queue-".concat(e)).on("postgres_changes",{event:"*",schema:"public",table:"call_queue",filter:"organization_id=eq.".concat(e)},async e=>{if(console.log("Queue change:",e),"INSERT"===e.eventType){let{data:t}=await l.from("donors").select("*").eq("id",e.new.donor_id).single();n(n=>[...n,{...e.new,donor:t}])}else"UPDATE"===e.eventType?n(t=>t.map(t=>t.id===e.new.id?{...t,...e.new}:t)):"DELETE"===e.eventType&&n(t=>t.filter(t=>t.id!==e.old.id))}).subscribe();async function a(){try{let{data:t,error:a}=await l.from("call_queue").select("\n            *,\n            donor:donors(*)\n          ").eq("organization_id",e).eq("status","pending").order("priority",{ascending:!1});if(a)throw a;n(t||[])}catch(e){console.error("Error loading queue:",e)}finally{r(!1)}}return()=>{l.removeChannel(t)}},[e]),{queue:t,loading:s}}}}]);