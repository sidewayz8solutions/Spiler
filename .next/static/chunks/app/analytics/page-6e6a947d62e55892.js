(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[109],{1023:function(e,t,a){Promise.resolve().then(a.bind(a,13079))},13079:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return _}});var n=a(3827),s=a(64090),r=a(26587),i=a(66363),o=a(38333),l=a(23356),c=a(22983),d=a(10166),u=a(98061),m=a(24897),x=a(98308),h=a(74994),g=a(81433),f=a(78720),v=a(44815),p=a(48290),j=a(71526),b=a(72951),y=a(1067),w=a(60017),N=a(8313),S=a(55138),D=a(87918);function _(){var e,t,a;let{user:_,organization:k}=(0,S.a)(),O=(0,N.useSupabase)(),[R,I]=(0,s.useState)("7d"),[P,E]=(0,s.useState)(!0),[z,Z]=(0,s.useState)({overview:{},dailyStats:[],topPerformers:[],outcomeDistribution:[],hourlyPerformance:[],donorSegments:[],campaignComparison:[]});async function A(){E(!0);try{let e=new Date,t=new Date;switch(R){case"24h":t.setDate(t.getDate()-1);break;case"7d":t.setDate(t.getDate()-7);break;case"30d":t.setDate(t.getDate()-30);break;case"90d":t.setDate(t.getDate()-90)}let[a,n,s,r,i,o,l]=await Promise.all([q(t,e),L(t,e),U(t,e),G(t,e),F(t,e),K(),M(t,e)]);Z({overview:a,dailyStats:n,topPerformers:s,outcomeDistribution:r,hourlyPerformance:i,donorSegments:o,campaignComparison:l})}catch(e){console.error("Error loading analytics:",e)}finally{E(!1)}}async function q(e,t){let{data:a}=await O.from("calls").select("*").eq("organization_id",k.id).gte("started_at",e.toISOString()).lte("started_at",t.toISOString()),{data:n}=await O.from("donations").select("*").eq("organization_id",k.id).gte("created_at",e.toISOString()).lte("created_at",t.toISOString()),s=(null==a?void 0:a.length)||0,r=(null==n?void 0:n.length)||0,i=(null==n?void 0:n.reduce((e,t)=>e+t.amount,0))||0,o=(null==a?void 0:a.reduce((e,t)=>e+(t.duration||0),0))/s||0,l=new Date(e),c=new Date(e);c.setDate(c.getDate()-(t-e)/864e5);let{data:d}=await O.from("donations").select("amount").eq("organization_id",k.id).gte("created_at",c.toISOString()).lt("created_at",l.toISOString()),u=(null==d?void 0:d.reduce((e,t)=>e+t.amount,0))||0;return{totalCalls:s,totalDonations:r,totalRaised:i,avgDonation:r>0?i/r:0,conversionRate:s>0?r/s*100:0,avgCallDuration:o,growthRate:u>0?(i-u)/u*100:0,dollarsPerCall:s>0?i/s:0}}async function L(e,t){let{data:a}=await O.from("donations").select("amount, created_at").eq("organization_id",k.id).gte("created_at",e.toISOString()).lte("created_at",t.toISOString()).order("created_at"),n={};return null==a||a.forEach(e=>{let t=new Date(e.created_at).toLocaleDateString();n[t]||(n[t]={date:t,amount:0,count:0}),n[t].amount+=e.amount,n[t].count+=1}),Object.values(n)}async function U(e,t){let{data:a}=await O.from("calls").select("\n        caller_id,\n        organization_members!inner(full_name),\n        donations(amount)\n      ").eq("organization_id",k.id).gte("started_at",e.toISOString()).lte("started_at",t.toISOString()),n={};return null==a||a.forEach(e=>{var t,a;let s=e.caller_id;n[s]||(n[s]={name:(null===(a=e.organization_members)||void 0===a?void 0:a.full_name)||"Unknown",calls:0,donations:0,raised:0}),n[s].calls+=1,(null===(t=e.donations)||void 0===t?void 0:t.length)>0&&(n[s].donations+=1,n[s].raised+=e.donations[0].amount)}),Object.values(n).sort((e,t)=>t.raised-e.raised).slice(0,10)}async function G(e,t){let{data:a}=await O.from("calls").select("outcome").eq("organization_id",k.id).gte("started_at",e.toISOString()).lte("started_at",t.toISOString()),n={};null==a||a.forEach(e=>{let t=e.outcome||"no_answer";n[t]=(n[t]||0)+1});let s={donated:"#10b981",callback:"#f59e0b",not_interested:"#ef4444",no_answer:"#6b7280",voicemail:"#8b5cf6"};return Object.entries(n).map(e=>{let[t,a]=e;return{name:t.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase()),value:Number(a),color:String(s[t]||"#6366f1")}})}async function F(e,t){let{data:a}=await O.from("calls").select("started_at, outcome").eq("organization_id",k.id).gte("started_at",e.toISOString()).lte("started_at",t.toISOString()),n={};for(let e=0;e<24;e++)n[e]={hour:e,calls:0,conversions:0};return null==a||a.forEach(e=>{let t=new Date(e.started_at).getHours();n[t].calls+=1,"donated"===e.outcome&&(n[t].conversions+=1)}),Object.values(n).map(e=>({...e,conversionRate:e.calls>0?e.conversions/e.calls*100:0,hour:"".concat(e.hour,":00")}))}async function K(){let{data:e}=await O.from("donors").select("previous_donation_amount").eq("organization_id",k.id),t={"New Prospects":0,"Small Donors":0,"Mid-Level":0,"Major Donors":0,VIP:0};null==e||e.forEach(e=>{let a=e.previous_donation_amount||0;0===a?t["New Prospects"]+=1:a<100?t["Small Donors"]+=1:a<500?t["Mid-Level"]+=1:a<2e3?t["Major Donors"]+=1:t.VIP+=1});let a=["#6366f1","#10b981","#f59e0b","#ef4444","#8b5cf6"];return Object.entries(t).map((e,t)=>{let[n,s]=e;return{name:n,value:s,color:a[t]}})}async function M(e,t){let{data:a}=await O.from("campaigns").select("\n        name,\n        donations(amount)\n      ").eq("organization_id",k.id);return(null==a?void 0:a.map(e=>{var t,a;return{name:e.name,raised:(null===(t=e.donations)||void 0===t?void 0:t.reduce((e,t)=>e+t.amount,0))||0,donations:(null===(a=e.donations)||void 0===a?void 0:a.length)||0}}).sort((e,t)=>t.raised-e.raised).slice(0,5))||[]}async function T(){var e,t;let a=[["Spiler Analytics Report"],["Organization: ".concat(k.name)],["Date Range: ".concat(R)],["Generated: ".concat(new Date().toLocaleString())],[],["Overview Metrics"],["Metric","Value"],["Total Calls",z.overview.totalCalls],["Total Donations",z.overview.totalDonations],["Total Raised",(0,D.xG)(z.overview.totalRaised)],["Average Donation",(0,D.xG)(z.overview.avgDonation)],["Conversion Rate","".concat(null===(e=z.overview.conversionRate)||void 0===e?void 0:e.toFixed(2),"%")],["Growth Rate","".concat(null===(t=z.overview.growthRate)||void 0===t?void 0:t.toFixed(2),"%")],[],["Top Performers"],["Name","Calls","Donations","Amount Raised"],...z.topPerformers.map(e=>[e.name,e.calls,e.donations,(0,D.xG)(e.raised)])].map(e=>e.join(",")).join("\n"),n=new Blob([a],{type:"text/csv"}),s=URL.createObjectURL(n),r=document.createElement("a");r.href=s,r.download="spiler-analytics-".concat(new Date().toISOString().split("T")[0],".csv"),r.click()}return((0,s.useEffect)(()=>{(null==k?void 0:k.id)&&A()},[k,R]),P)?(0,n.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-spiler-darker to-spiler-dark",children:[(0,n.jsx)(w.Z,{}),(0,n.jsx)("div",{className:"flex items-center justify-center h-96",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-500 mx-auto"}),(0,n.jsx)("p",{className:"mt-4 text-gray-400",children:"Loading analytics..."})]})})]}):(0,n.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-spiler-darker to-spiler-dark",children:[(0,n.jsx)(w.Z,{}),(0,n.jsxs)("main",{className:"max-w-7xl mx-auto px-4 py-8",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-gradient",children:"Campaign Analytics"}),(0,n.jsx)("p",{className:"text-gray-400",children:"Track performance and maximize your fundraising impact"})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsxs)("select",{value:R,onChange:e=>I(e.target.value),className:"input",children:[(0,n.jsx)("option",{value:"24h",children:"Last 24 Hours"}),(0,n.jsx)("option",{value:"7d",children:"Last 7 Days"}),(0,n.jsx)("option",{value:"30d",children:"Last 30 Days"}),(0,n.jsx)("option",{value:"90d",children:"Last 90 Days"})]}),(0,n.jsxs)("button",{onClick:T,className:"btn btn-primary flex items-center space-x-2",children:[(0,n.jsx)(v.Z,{className:"w-5 h-5"}),(0,n.jsx)("span",{children:"Export Report"})]})]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,n.jsx)(C,{title:"Total Raised",value:(0,D.xG)(z.overview.totalRaised),change:"".concat((null!==(t=z.overview.growthRate)&&void 0!==t?t:0)>0?"+":"").concat((null!==(a=z.overview.growthRate)&&void 0!==a?a:0).toFixed(1),"%"),icon:p.Z,color:"from-green-500 to-emerald-600",subtitle:"Avg: ".concat((0,D.xG)(z.overview.avgDonation))}),(0,n.jsx)(C,{title:"Conversion Rate",value:"".concat(null===(e=z.overview.conversionRate)||void 0===e?void 0:e.toFixed(1),"%"),change:"".concat(z.overview.totalDonations," donations"),icon:j.Z,color:"from-purple-500 to-pink-600",subtitle:"From ".concat(z.overview.totalCalls," calls")}),(0,n.jsx)(C,{title:"$/Call",value:(0,D.xG)(z.overview.dollarsPerCall),change:"Key efficiency metric",icon:b.Z,color:"from-indigo-500 to-blue-600",subtitle:"Revenue per dial"}),(0,n.jsx)(C,{title:"Avg Call Time",value:(0,D.LU)(z.overview.avgCallDuration),change:"".concat(z.overview.totalCalls," total calls"),icon:y.Z,color:"from-orange-500 to-red-600",subtitle:"Call efficiency"})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[(0,n.jsxs)("div",{className:"card",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Daily Fundraising Trend"}),(0,n.jsx)(r.h,{width:"100%",height:300,children:(0,n.jsxs)(i.w,{data:z.dailyStats,children:[(0,n.jsx)(o.q,{strokeDasharray:"3 3",stroke:"#374151"}),(0,n.jsx)(l.K,{dataKey:"date",stroke:"#9ca3af"}),(0,n.jsx)(c.B,{stroke:"#9ca3af"}),(0,n.jsx)(d.u,{contentStyle:{backgroundColor:"#1a1a2e",border:"1px solid #6366f1"},formatter:e=>(0,D.xG)(e)}),(0,n.jsx)(u.x,{type:"monotone",dataKey:"amount",stroke:"#6366f1",strokeWidth:2,dot:{fill:"#6366f1"}})]})})]}),(0,n.jsxs)("div",{className:"card",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Call Outcome Distribution"}),(0,n.jsx)(r.h,{width:"100%",height:300,children:(0,n.jsxs)(m.u,{children:[(0,n.jsx)(x.b,{data:z.outcomeDistribution,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:5,dataKey:"value",children:z.outcomeDistribution.map((e,t)=>(0,n.jsx)(h.b,{fill:e.color},"cell-".concat(t)))}),(0,n.jsx)(d.u,{contentStyle:{backgroundColor:"#1a1a2e",border:"1px solid #6366f1"}})]})}),(0,n.jsx)("div",{className:"flex flex-wrap gap-2 mt-4",children:z.outcomeDistribution.map(e=>(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:e.color}}),(0,n.jsxs)("span",{className:"text-xs text-gray-400",children:[e.name,": ",e.value]})]},e.name))})]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6",children:[(0,n.jsxs)("div",{className:"card lg:col-span-2",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Optimal Calling Hours"}),(0,n.jsx)(r.h,{width:"100%",height:250,children:(0,n.jsxs)(g.v,{data:z.hourlyPerformance,children:[(0,n.jsx)(o.q,{strokeDasharray:"3 3",stroke:"#374151"}),(0,n.jsx)(l.K,{dataKey:"hour",stroke:"#9ca3af"}),(0,n.jsx)(c.B,{yAxisId:"left",stroke:"#9ca3af"}),(0,n.jsx)(c.B,{yAxisId:"right",orientation:"right",stroke:"#10b981"}),(0,n.jsx)(d.u,{contentStyle:{backgroundColor:"#1a1a2e",border:"1px solid #6366f1"}}),(0,n.jsx)(f.$,{yAxisId:"left",dataKey:"calls",fill:"#6366f1"}),(0,n.jsx)(u.x,{yAxisId:"right",type:"monotone",dataKey:"conversionRate",stroke:"#10b981"})]})})]}),(0,n.jsxs)("div",{className:"card",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Donor Segments"}),(0,n.jsx)("div",{className:"space-y-3",children:z.donorSegments.map(e=>(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,n.jsx)("span",{children:e.name}),(0,n.jsx)("span",{className:"text-gray-400",children:e.value})]}),(0,n.jsx)("div",{className:"h-2 bg-spiler-dark rounded-full overflow-hidden",children:(0,n.jsx)("div",{className:"h-full transition-all",style:{width:"".concat(e.value/Math.max(...z.donorSegments.map(e=>e.value))*100,"%"),backgroundColor:e.color}})})]},e.name))})]})]}),(0,n.jsxs)("div",{className:"card",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Top Fundraisers Leaderboard \uD83C\uDFC6"}),(0,n.jsx)("div",{className:"overflow-x-auto",children:(0,n.jsxs)("table",{className:"w-full",children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{className:"border-b border-indigo-500/20",children:[(0,n.jsx)("th",{className:"text-left py-3 px-4",children:"Rank"}),(0,n.jsx)("th",{className:"text-left py-3 px-4",children:"Name"}),(0,n.jsx)("th",{className:"text-center py-3 px-4",children:"Calls"}),(0,n.jsx)("th",{className:"text-center py-3 px-4",children:"Donations"}),(0,n.jsx)("th",{className:"text-center py-3 px-4",children:"Conversion"}),(0,n.jsx)("th",{className:"text-right py-3 px-4",children:"Amount Raised"})]})}),(0,n.jsx)("tbody",{children:z.topPerformers.map((e,t)=>(0,n.jsxs)("tr",{className:"border-b border-gray-800 hover:bg-white/5",children:[(0,n.jsxs)("td",{className:"py-3 px-4",children:[0===t&&(0,n.jsx)("span",{className:"text-2xl",children:"\uD83E\uDD47"}),1===t&&(0,n.jsx)("span",{className:"text-2xl",children:"\uD83E\uDD48"}),2===t&&(0,n.jsx)("span",{className:"text-2xl",children:"\uD83E\uDD49"}),t>2&&(0,n.jsxs)("span",{className:"text-gray-400",children:["#",t+1]})]}),(0,n.jsx)("td",{className:"py-3 px-4 font-medium",children:e.name}),(0,n.jsx)("td",{className:"text-center py-3 px-4",children:e.calls}),(0,n.jsx)("td",{className:"text-center py-3 px-4",children:e.donations}),(0,n.jsx)("td",{className:"text-center py-3 px-4",children:(0,n.jsxs)("span",{className:"badge bg-indigo-500/20 text-indigo-400",children:[e.calls>0?(e.donations/e.calls*100).toFixed(1):0,"%"]})}),(0,n.jsx)("td",{className:"text-right py-3 px-4 font-bold text-green-400",children:(0,D.xG)(e.raised)})]},t))})]})})]}),z.campaignComparison.length>0&&(0,n.jsxs)("div",{className:"card mt-6",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold mb-4",children:"Campaign Performance Comparison"}),(0,n.jsx)(r.h,{width:"100%",height:250,children:(0,n.jsxs)(g.v,{data:z.campaignComparison,children:[(0,n.jsx)(o.q,{strokeDasharray:"3 3",stroke:"#374151"}),(0,n.jsx)(l.K,{dataKey:"name",stroke:"#9ca3af"}),(0,n.jsx)(c.B,{stroke:"#9ca3af"}),(0,n.jsx)(d.u,{contentStyle:{backgroundColor:"#1a1a2e",border:"1px solid #6366f1"},formatter:e=>(0,D.xG)(e)}),(0,n.jsx)(f.$,{dataKey:"raised",fill:"#6366f1"})]})})]})]})]})}function C(e){let{title:t,value:a,change:s,icon:r,color:i,subtitle:o}=e;return(0,n.jsx)("div",{className:"card hover:scale-105 transition-transform",children:(0,n.jsxs)("div",{className:"flex items-start justify-between",children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("p",{className:"text-gray-400 text-sm mb-1",children:t}),(0,n.jsx)("p",{className:"text-3xl font-bold",children:a}),o&&(0,n.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:o}),(0,n.jsx)("p",{className:"text-xs mt-2 ".concat((null==s?void 0:s.startsWith("+"))?"text-green-400":"text-gray-400"),children:s})]}),(0,n.jsx)("div",{className:"p-3 rounded-lg bg-gradient-to-r ".concat(i),children:(0,n.jsx)(r,{className:"w-6 h-6 text-white"})})]})})}},60017:function(e,t,a){"use strict";a.d(t,{Z:function(){return v}});var n=a(3827),s=a(64090),r=a(8792),i=a(47907),o=a(55138),l=a(3478),c=a(3251),d=a(53404),u=a(89812),m=a(34102),x=a(28042),h=a(58621),g=a(12360);let f=[{href:"/",label:"Dashboard",icon:l.Z},{href:"/dialer",label:"Dialer",icon:c.Z},{href:"/queue",label:"Queue",icon:d.Z},{href:"/donors",label:"Donors",icon:u.Z},{href:"/analytics",label:"Analytics",icon:l.Z},{href:"/settings",label:"Settings",icon:m.Z}];function v(){let e=(0,i.usePathname)(),{user:t,signOut:a}=(0,o.a)(),[l,c]=(0,s.useState)(!1);return(0,n.jsxs)("nav",{className:"bg-spiler-dark/50 backdrop-blur-lg border-b border-indigo-500/10 sticky top-0 z-50",children:[(0,n.jsx)("div",{className:"max-w-7xl mx-auto px-4",children:(0,n.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,n.jsxs)(r.default,{href:"/",className:"flex items-center space-x-2",children:[(0,n.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCDE"}),(0,n.jsx)("span",{className:"text-xl font-bold text-gradient",children:"Spiler"})]}),(0,n.jsx)("div",{className:"hidden md:flex items-center space-x-1",children:f.map(t=>{let a=t.icon,s=e===t.href;return(0,n.jsxs)(r.default,{href:t.href,className:"\n                    flex items-center space-x-2 px-4 py-2 rounded-lg transition-all\n                    ".concat(s?"bg-indigo-500/20 text-indigo-400":"text-gray-400 hover:text-white hover:bg-white/5","\n                  "),children:[(0,n.jsx)(a,{className:"w-5 h-5"}),(0,n.jsx)("span",{children:t.label})]},t.href)})}),(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsxs)("div",{className:"hidden md:flex items-center space-x-3",children:[(0,n.jsx)("span",{className:"text-sm text-gray-400",children:null==t?void 0:t.email}),(0,n.jsx)("button",{onClick:a,className:"p-2 text-gray-400 hover:text-white transition-colors",title:"Sign out",children:(0,n.jsx)(x.Z,{className:"w-5 h-5"})})]}),(0,n.jsx)("button",{onClick:()=>c(!l),className:"md:hidden p-2 text-gray-400 hover:text-white",children:l?(0,n.jsx)(h.Z,{className:"w-6 h-6"}):(0,n.jsx)(g.Z,{className:"w-6 h-6"})})]})]})}),l&&(0,n.jsx)("div",{className:"md:hidden bg-spiler-dark border-t border-indigo-500/10",children:(0,n.jsxs)("div",{className:"px-4 py-4 space-y-2",children:[f.map(t=>{let a=t.icon,s=e===t.href;return(0,n.jsxs)(r.default,{href:t.href,onClick:()=>c(!1),className:"\n                    flex items-center space-x-3 px-4 py-3 rounded-lg transition-all\n                    ".concat(s?"bg-indigo-500/20 text-indigo-400":"text-gray-400 hover:text-white hover:bg-white/5","\n                  "),children:[(0,n.jsx)(a,{className:"w-5 h-5"}),(0,n.jsx)("span",{children:t.label})]},t.href)}),(0,n.jsxs)("button",{onClick:a,className:"flex items-center space-x-3 px-4 py-3 text-red-400 hover:bg-red-500/10 rounded-lg w-full",children:[(0,n.jsx)(x.Z,{className:"w-5 h-5"}),(0,n.jsx)("span",{children:"Sign Out"})]})]})})]})}},8313:function(e,t,a){"use strict";a.r(t),a.d(t,{Providers:function(){return u},SupabaseContext:function(){return d},useSupabase:function(){return m}});var n=a(3827),s=a(64090),r=a(47907),i=a(58714),o=a(52688),l=a(47082);let c=new o.S,d=(0,s.createContext)(null);function u(e){let{children:t}=e,[a]=(0,s.useState)(()=>(0,i.createClientComponentClient)()),o=(0,r.useRouter)();return(0,s.useEffect)(()=>{let{data:{subscription:e}}=a.auth.onAuthStateChange(e=>{"SIGNED_OUT"===e&&o.push("/auth/login")});return()=>{e.unsubscribe()}},[a,o]),(0,n.jsx)(d.Provider,{value:a,children:(0,n.jsx)(l.aH,{client:c,children:t})})}let m=()=>{let e=(0,s.useContext)(d);if(!e)throw Error("useSupabase must be used within SupabaseProvider");return e}},55138:function(e,t,a){"use strict";a.d(t,{a:function(){return l}});var n=a(64090),s=a(8313),r=a(22020),i=a(65249);let o=(0,r.Ue)((0,i.tJ)(e=>({user:null,organization:null,teamMember:null,setUser:t=>e({user:t}),setOrganization:t=>e({organization:t}),setTeamMember:t=>e({teamMember:t}),reset:()=>e({user:null,organization:null,teamMember:null})}),{name:"spiler-auth"}));function l(){let e=(0,s.useSupabase)(),{user:t,organization:a,teamMember:r,setUser:i,setOrganization:l,setTeamMember:c,reset:d}=o(),[u,m]=(0,n.useState)(!0);async function x(){try{let{data:{user:t}}=await e.auth.getUser();if(t){i(t);let{data:a}=await e.from("team_members").select("\n            *,\n            organization:organizations(*)\n          ").eq("user_id",t.id).single();a&&(c(a),l(a.organization))}}catch(e){console.error("Error loading user:",e)}finally{m(!1)}}return(0,n.useEffect)(()=>{x();let{data:{subscription:t}}=e.auth.onAuthStateChange(async(e,t)=>{t?await x():d()});return()=>t.unsubscribe()},[]),{user:t,organization:a,teamMember:r,loading:u,signIn:async function(t,a){let{data:n,error:s}=await e.auth.signInWithPassword({email:t,password:a});if(s)throw s;return n},signUp:async function(t,a){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{data:s,error:r}=await e.auth.signUp({email:t,password:a,options:{data:n}});if(r)throw r;return s},signOut:async function(){let{error:t}=await e.auth.signOut();if(t)throw t;d()}}}},87918:function(e,t,a){"use strict";function n(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e||0)}function s(e){let t=Math.floor(e/3600),a=Math.floor(e%3600/60),n=e%60;return t>0?"".concat(t,":").concat(a.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0")):"".concat(a,":").concat(n.toString().padStart(2,"0"))}a.d(t,{LU:function(){return s},xG:function(){return n}})}},function(e){e.O(0,[508,409,366,971,69,744],function(){return e(e.s=1023)}),_N_E=e.O()}]);