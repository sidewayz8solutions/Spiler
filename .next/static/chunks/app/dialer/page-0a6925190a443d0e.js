(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[263],{6800:function(e,t,a){Promise.resolve().then(a.bind(a,1373))},1373:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return S}});var n=a(3827),r=a(64090),o=a(10963);let l=r.forwardRef(function(e,t){let{title:a,titleId:n,...o}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},o),a?r.createElement("title",{id:n},a):null,r.createElement("path",{fillRule:"evenodd",d:"M1.5 4.5a3 3 0 0 1 3-3h1.372c.86 0 1.61.586 1.819 1.42l1.105 4.423a1.875 1.875 0 0 1-.694 1.955l-1.293.97c-.135.101-.164.249-.126.352a11.285 11.285 0 0 0 6.697 6.697c.103.038.25.009.352-.126l.97-1.293a1.875 1.875 0 0 1 1.955-.694l4.423 1.105c.834.209 1.42.959 1.42 1.82V19.5a3 3 0 0 1-3 3h-2.25C8.552 22.5 1.5 15.448 1.5 6.75V4.5Z",clipRule:"evenodd"}))}),s=r.forwardRef(function(e,t){let{title:a,titleId:n,...o}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},o),a?r.createElement("title",{id:n},a):null,r.createElement("path",{d:"M5.055 7.06C3.805 6.347 2.25 7.25 2.25 8.69v8.122c0 1.44 1.555 2.343 2.805 1.628L12 14.471v2.34c0 1.44 1.555 2.343 2.805 1.628l7.108-4.061c1.26-.72 1.26-2.536 0-3.256l-7.108-4.061C13.555 6.346 12 7.249 12 8.689v2.34L5.055 7.061Z"}))});function i(e){let{onStartCall:t,onSkip:a,disabled:r}=e;return(0,n.jsxs)("div",{className:"card",children:[(0,n.jsx)("h3",{className:"font-semibold mb-4",children:"Call Controls"}),(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("button",{onClick:t,disabled:r,className:"w-full btn btn-primary py-4 text-lg disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,n.jsx)(l,{className:"w-6 h-6 mr-2"}),"Start Call"]}),(0,n.jsxs)("button",{onClick:a,disabled:r,className:"w-full btn btn-secondary py-3",children:[(0,n.jsx)(s,{className:"w-5 h-5 mr-2"}),"Skip to Next"]})]}),(0,n.jsx)("div",{className:"mt-4 p-3 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:(0,n.jsx)("p",{className:"text-xs text-blue-400",children:"Clicking \"Start Call\" will open your phone's dialer with the donor's number"})})]})}var c=a(1067);function d(e){let{duration:t}=e,[a,o]=(0,r.useState)(t||0);return(0,r.useEffect)(()=>{let e=setInterval(()=>{o(e=>e+1)},1e3);return()=>clearInterval(e)},[]),(0,n.jsx)("div",{className:"card bg-green-500/10 border-green-500/20",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsx)("div",{className:"p-2 bg-green-500/20 rounded-lg",children:(0,n.jsx)(c.Z,{className:"w-5 h-5 text-green-400"})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("p",{className:"text-xs text-gray-400",children:"Call Duration"}),(0,n.jsx)("p",{className:"text-2xl font-bold font-mono text-green-400",children:"".concat(Math.floor(a/60).toString().padStart(2,"0"),":").concat((a%60).toString().padStart(2,"0"))})]})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsxs)("span",{className:"relative flex h-3 w-3",children:[(0,n.jsx)("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"}),(0,n.jsx)("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-green-500"})]}),(0,n.jsx)("span",{className:"text-sm text-green-400",children:"Active"})]})]})})}var u=a(48290),m=a(58621);function h(e){let{donor:t,onSubmit:a,onCancel:o}=e,[l,s]=(0,r.useState)(""),[i,c]=(0,r.useState)(""),[d,h]=(0,r.useState)(!1),x=async e=>{if(e.preventDefault(),!(!l||isNaN(parseFloat(l))||0>=parseFloat(l))){h(!0);try{await a(parseFloat(l),i)}finally{h(!1)}}};return(0,n.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:(0,n.jsxs)("div",{className:"card max-w-md w-full mx-4",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsx)("div",{className:"p-2 bg-green-500/20 rounded-lg",children:(0,n.jsx)(u.Z,{className:"w-5 h-5 text-green-400"})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"font-semibold text-white",children:"Record Donation"}),(0,n.jsx)("p",{className:"text-sm text-gray-400",children:null==t?void 0:t.full_name})]})]}),(0,n.jsx)("button",{type:"button",onClick:o,className:"p-1 hover:bg-gray-700 rounded-lg transition-colors",title:"Close donation form",children:(0,n.jsx)(m.Z,{className:"w-5 h-5 text-gray-400"})})]}),(0,n.jsxs)("form",{onSubmit:x,className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"amount",className:"block text-sm font-medium text-gray-300 mb-2",children:"Donation Amount ($)"}),(0,n.jsx)("input",{type:"number",id:"amount",value:l,onChange:e=>s(e.target.value),className:"input",placeholder:"0.00",min:"0",step:"0.01",required:!0,autoFocus:!0})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-300 mb-2",children:"Notes (Optional)"}),(0,n.jsx)("textarea",{id:"notes",value:i,onChange:e=>c(e.target.value),className:"input min-h-[80px] resize-none",placeholder:"Any additional notes about the donation..."})]}),(0,n.jsxs)("div",{className:"flex space-x-3 pt-4",children:[(0,n.jsx)("button",{type:"button",onClick:o,className:"flex-1 px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg transition-colors",disabled:d,children:"Cancel"}),(0,n.jsx)("button",{type:"submit",className:"flex-1 px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg transition-colors disabled:opacity-50",disabled:d||!l,children:d?"Recording...":"Record Donation"})]})]})]})})}var x=a(3251);let p=r.forwardRef(function(e,t){let{title:a,titleId:n,...o}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},o),a?r.createElement("title",{id:n},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"}))});function g(e){let{donor:t}=e,a=t.previous_donation_amount>1e3?{text:"Major Donor",color:"bg-yellow-500"}:t.previous_donation_amount>500?{text:"High Value",color:"bg-purple-500"}:t.previous_donation_amount>0?{text:"Previous Donor",color:"bg-green-500"}:{text:"New Prospect",color:"bg-blue-500"};return(0,n.jsxs)("div",{className:"card gradient-border",children:[(0,n.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("h2",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[t.full_name,(0,n.jsx)("span",{className:"".concat(a.color," text-white text-xs px-2 py-1 rounded-full"),children:a.text})]}),(0,n.jsxs)("div",{className:"flex items-center gap-4 mt-2",children:[(0,n.jsxs)("div",{className:"flex items-center text-gray-400",children:[(0,n.jsx)(x.Z,{className:"w-4 h-4 mr-1"}),(0,n.jsx)("span",{className:"text-sm",children:t.phone})]}),t.email&&(0,n.jsxs)("div",{className:"flex items-center text-gray-400",children:[(0,n.jsx)(p,{className:"w-4 h-4 mr-1"}),(0,n.jsx)("span",{className:"text-sm",children:t.email})]})]})]}),(0,n.jsxs)("div",{className:"text-right",children:[(0,n.jsx)("p",{className:"text-sm text-gray-400",children:"Score"}),(0,n.jsx)("p",{className:"text-2xl font-bold text-gradient",children:t.score||50})]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4 border-t border-indigo-500/20",children:[(0,n.jsxs)("div",{className:"glass rounded-lg p-3",children:[(0,n.jsx)("p",{className:"text-xs text-gray-400 mb-1",children:"Previous Donation"}),(0,n.jsxs)("p",{className:"text-lg font-semibold",children:["$",t.previous_donation_amount||0]})]}),(0,n.jsxs)("div",{className:"glass rounded-lg p-3",children:[(0,n.jsx)("p",{className:"text-xs text-gray-400 mb-1",children:"Total Donated"}),(0,n.jsxs)("p",{className:"text-lg font-semibold",children:["$",t.total_donated||0]})]}),(0,n.jsxs)("div",{className:"glass rounded-lg p-3",children:[(0,n.jsx)("p",{className:"text-xs text-gray-400 mb-1",children:"Last Contact"}),(0,n.jsx)("p",{className:"text-lg font-semibold",children:t.last_contact_date?new Date(t.last_contact_date).toLocaleDateString():"Never"})]})]}),t.notes&&(0,n.jsxs)("div",{className:"mt-4 p-3 bg-yellow-500/10 border border-yellow-500/20 rounded-lg",children:[(0,n.jsx)("p",{className:"text-sm text-yellow-400",children:"Previous Notes:"}),(0,n.jsx)("p",{className:"text-sm mt-1",children:t.notes})]})]})}let f=r.forwardRef(function(e,t){let{title:a,titleId:n,...o}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},o),a?r.createElement("title",{id:n},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18.364 18.364A9 9 0 0 0 5.636 5.636m12.728 12.728A9 9 0 0 1 5.636 5.636m12.728 12.728L5.636 5.636"}))}),b=r.forwardRef(function(e,t){let{title:a,titleId:n,...o}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},o),a?r.createElement("title",{id:n},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.114 5.636a9 9 0 0 1 0 12.728M16.463 8.288a5.25 5.25 0 0 1 0 7.424M6.75 8.25l4.72-4.72a.75.75 0 0 1 1.28.53v15.88a.75.75 0 0 1-1.28.53l-4.72-4.72H4.51c-.88 0-1.704-.507-1.938-1.354A9.009 9.009 0 0 1 2.25 12c0-.83.112-1.633.322-2.396C2.806 8.756 3.63 8.25 4.51 8.25H6.75Z"}))});function v(e){let{onSelectOutcome:t}=e,a=[{id:"donated",label:"Donated",icon:u.Z,color:"bg-green-500 hover:bg-green-600",description:"Donor made a contribution"},{id:"callback",label:"Call Back",icon:x.Z,color:"bg-yellow-500 hover:bg-yellow-600",description:"Schedule a follow-up call"},{id:"not_interested",label:"Not Interested",icon:m.Z,color:"bg-red-500 hover:bg-red-600",description:"Donor declined to contribute"},{id:"no_answer",label:"No Answer",icon:f,color:"bg-gray-500 hover:bg-gray-600",description:"No one answered the call"},{id:"voicemail",label:"Voicemail",icon:b,color:"bg-purple-500 hover:bg-purple-600",description:"Left a voicemail message"}];return(0,n.jsxs)("div",{className:"card",children:[(0,n.jsx)("h3",{className:"font-semibold mb-4",children:"Call Outcome"}),(0,n.jsx)("div",{className:"space-y-3",children:a.map(e=>{let a=e.icon;return(0,n.jsx)("button",{type:"button",onClick:()=>t(e.id),className:"w-full p-4 rounded-lg text-white font-medium transition-all duration-200 transform hover:scale-105 ".concat(e.color),children:(0,n.jsxs)("div",{className:"flex items-center justify-center space-x-3",children:[(0,n.jsx)(a,{className:"w-5 h-5"}),(0,n.jsx)("span",{children:e.label})]})},e.id)})}),(0,n.jsx)("div",{className:"mt-4 p-3 bg-blue-500/10 border border-blue-500/20 rounded-lg",children:(0,n.jsx)("p",{className:"text-xs text-blue-400",children:"Select the outcome of your call to record it and move to the next donor"})})]})}let w=r.forwardRef(function(e,t){let{title:a,titleId:n,...o}=e;return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},o),a?r.createElement("title",{id:n},a):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z"}))});function j(e){let{donor:t}=e,[a,o]=(0,r.useState)(null),[l,s]=(0,r.useState)("opening");if((0,r.useEffect)(()=>{o(function(e){var t;let a=e.previous_donation_amount>0,n=e.first_name||(null===(t=e.full_name)||void 0===t?void 0:t.split(" ")[0])||"there",r=new Date().getHours();return{opening:"".concat(r<12?"Good morning":r<17?"Good afternoon":"Good evening"," ").concat(n,", this is {fundraiser_name} from {campaign_name}. ").concat(a?"Thank you so much for your previous support of $".concat(e.previous_donation_amount,". Your generosity made a real difference."):"I'm reaching out to supporters in our community who care about making a difference."," Do you have a moment to talk?"),pitch:a?"As you know from your previous involvement, we're working hard to [campaign goal]. Thanks to supporters like you, we've already [achievement]. Now we're in the final push and every contribution matters.":"We're working to [campaign goal] and we're reaching out to community members who might be interested in supporting our cause. We've already [achievement] and with your help, we can [future goal].",ask:a?"Would you consider matching or even increasing your previous donation of $".concat(e.previous_donation_amount,"? Many of our supporters are doubling their impact this time around."):"Would you be willing to support our campaign today? We have supporters contributing anywhere from $25 to $500, and every amount makes a difference.",objections:{"I don't have money right now":a?"I completely understand. Would you consider a smaller amount, even $25 would help us reach our goal. Or we could schedule a pledge for next month?":"I understand completely. Even a small contribution of $10 or $15 can make a difference. Or if you'd prefer, I can follow up with you next month.","I already donated":"Thank you so much for your support! Your previous contribution means a lot. Many of our strongest supporters are choosing to give again to help us reach our goal. Would you consider an additional contribution?","I need to think about it":"Of course, it's an important decision. Can I answer any questions about how the funds will be used? I'd also be happy to send you more information and follow up in a few days.","Not interested":"I understand, and I appreciate you taking the time to speak with me. Before I go, is there anything specific about our campaign that concerns you? Your feedback is valuable to us.","How will the money be used?":"Great question! [Specific breakdown of fund usage]. We're committed to transparency and can provide detailed reports on how every dollar is spent."},closing:"Thank you so much for your time today, ".concat(n,". ").concat(a?"Your continued support means everything to us.":"We're grateful for your consideration."," Have a wonderful ").concat(r>=17?"evening":"day","!")}}(t))},[t]),!a)return null;let i=[{id:"opening",label:"Opening",content:a.opening},{id:"pitch",label:"Pitch",content:a.pitch},{id:"ask",label:"Ask",content:a.ask},{id:"objections",label:"Objections",content:a.objections},{id:"closing",label:"Closing",content:a.closing}];return(0,n.jsxs)("div",{className:"card",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,n.jsx)("h3",{className:"text-lg font-semibold",children:"AI Script Assistant"}),(0,n.jsx)(w,{className:"w-5 h-5 text-indigo-400"})]}),(0,n.jsx)("div",{className:"flex space-x-2 mb-4 overflow-x-auto",children:i.map(e=>(0,n.jsx)("button",{onClick:()=>s(e.id),className:"\n              px-4 py-2 rounded-lg text-sm font-medium transition-all whitespace-nowrap\n              ".concat(l===e.id?"bg-indigo-500 text-white":"bg-spiler-dark/50 text-gray-400 hover:text-white","\n            "),children:e.label},e.id))}),(0,n.jsx)("div",{className:"bg-spiler-dark/30 rounded-lg p-4",children:i.map(e=>(0,n.jsx)("div",{className:l===e.id?"block":"hidden",children:"objections"===e.id?(0,n.jsx)("div",{className:"space-y-3",children:Object.entries(e.content).map(e=>{let[t,a]=e;return(0,n.jsxs)("div",{children:[(0,n.jsxs)("p",{className:"text-sm text-red-400 mb-1",children:['"',t,'"']}),(0,n.jsx)("p",{className:"text-sm pl-4 border-l-2 border-indigo-500",children:a})]},t)})}):(0,n.jsx)("p",{className:"text-sm leading-relaxed",children:e.content})},e.id))}),(0,n.jsxs)("div",{className:"mt-4 p-3 bg-indigo-500/10 border border-indigo-500/20 rounded-lg",children:[(0,n.jsx)("p",{className:"text-xs text-indigo-400 font-semibold mb-1",children:"\uD83D\uDCA1 Quick Tip:"}),(0,n.jsx)("p",{className:"text-xs text-gray-300",children:t.previous_donation_amount>0?"Reference their previous support early in the conversation":"Focus on the impact their first donation will make"})]})]})}var y=a(60017),N=a(55138),k=a(22020),_=a(8313);let C=(0,k.Ue)((e,t)=>({currentDonor:null,currentCall:null,isCallActive:!1,callStartTime:null,callDuration:0,queue:[],setCurrentDonor:t=>e({currentDonor:t}),setCurrentCall:t=>e({currentCall:t}),setCallActive:t=>e({isCallActive:t}),setCallStartTime:t=>e({callStartTime:t}),setCallDuration:t=>e({callDuration:t}),setQueue:t=>e({queue:t}),reset:()=>e({currentDonor:null,currentCall:null,isCallActive:!1,callStartTime:null,callDuration:0})}));var D=a(45167);function S(){let{user:e,organization:t}=(0,N.a)(),{queue:a}=(0,D.q_)(null==t?void 0:t.id),{currentDonor:l,isCallActive:s,callDuration:c,loadNextDonor:u,startCall:m,endCall:x,recordOutcome:p}=function(){let e=(0,_.useSupabase)(),{organization:t,teamMember:a}=(0,N.a)(),{currentDonor:n,currentCall:r,isCallActive:l,callDuration:s,queue:i,setCurrentDonor:c,setCurrentCall:d,setCallActive:u,setCallStartTime:m,setCallDuration:h,setQueue:x,reset:p}=C();async function g(r){try{let{data:o,error:l}=await e.from("calls").insert({organization_id:t.id,donor_id:r,team_member_id:a.id,phone_number:n.phone,status:"active",started_at:new Date().toISOString()}).select().single();if(l)throw l;d(o),u(!0),m(Date.now());let s=setInterval(()=>{let e=Math.floor((Date.now()-Date.now())/1e3);h(e)},1e3);return window.callTimer=s,o}catch(e){console.error("Error starting call:",e),o.default.error("Failed to start call")}}async function f(){window.callTimer&&clearInterval(window.callTimer);let t=Math.floor((Date.now()-get().callStartTime)/1e3);try{let{error:a}=await e.from("calls").update({ended_at:new Date().toISOString(),duration_seconds:t,status:"completed"}).eq("id",r.id);if(a)throw a;u(!1),h(0)}catch(e){console.error("Error ending call:",e)}}async function b(a){let l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";try{let{error:o}=await e.from("calls").update({outcome:a,donation_amount:l,notes:i,ended_at:new Date().toISOString(),duration_seconds:s}).eq("id",r.id);if(o)throw o;let{error:c}=await e.from("donors").update({status:"donated"===a?"donated":a,last_contact_date:new Date().toISOString(),notes:i?"".concat(n.notes||"","\n\n").concat(new Date().toLocaleDateString(),": ").concat(i):n.notes}).eq("id",n.id);if(c)throw c;if("donated"===a&&l){let{error:a}=await e.from("donations").insert({organization_id:t.id,donor_id:n.id,call_id:r.id,amount:l,payment_status:"pending",notes:i});if(a)throw a}return await e.from("call_queue").update({status:"completed"}).eq("donor_id",n.id).eq("organization_id",t.id),u(!1),d(null),h(0),!0}catch(e){return console.error("Error recording outcome:",e),o.default.error("Failed to record outcome"),!1}}return{currentDonor:n,currentCall:r,isCallActive:l,callDuration:s,queue:i,loadNextDonor:async function(){try{let{data:n,error:r}=await e.rpc("get_next_donor",{org_id:t.id,member_id:a.id});if(r)throw r;if(n&&n.length>0){let t=n[0],{data:a}=await e.from("donors").select("*").eq("id",t.donor_id).single();if(a)return c(a),a}else o.default.error("No more donors in queue"),c(null)}catch(e){console.error("Error loading next donor:",e),o.default.error("Failed to load next donor")}},startCall:g,endCall:f,recordOutcome:b}}(),[f,b]=(0,r.useState)(!1),[w,k]=(0,r.useState)(null);(0,r.useEffect)(()=>{!l&&a.length>0&&u()},[a]);let S=async()=>{if(!l){o.default.error("No donor loaded");return}window.location.href="tel:".concat(l.phone),await m(l.id),o.default.success("Calling ".concat(l.full_name))},E=async e=>{k(e),"donated"===e?b(!0):(await p(e),await u(),o.default.success("Call recorded"))},L=async(e,t)=>{await p("donated",e,t),b(!1),await u(),o.default.success("Donation of $".concat(e," recorded! \uD83C\uDF89"))};return(0,n.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-spiler-darker to-spiler-dark",children:[(0,n.jsx)(y.Z,{}),(0,n.jsxs)("main",{className:"max-w-6xl mx-auto px-4 py-8",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-gradient",children:"Dialer"}),(0,n.jsxs)("p",{className:"text-gray-400",children:[a.length," donors in queue"]})]}),(0,n.jsxs)("div",{className:"w-64",children:[(0,n.jsxs)("div",{className:"flex justify-between text-sm text-gray-400 mb-2",children:[(0,n.jsx)("span",{children:"Progress"}),(0,n.jsxs)("span",{children:[Math.round((1-a.length/100)*100),"%"]})]}),(0,n.jsx)("div",{className:"h-2 bg-spiler-dark rounded-full overflow-hidden",children:(0,n.jsx)("div",{className:"h-full bg-gradient-to-r from-indigo-500 to-purple-600 transition-all",style:{width:"".concat(Math.round((1-a.length/100)*100),"%")}})})]})]}),(0,n.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,n.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[l?(0,n.jsx)(g,{donor:l}):(0,n.jsxs)("div",{className:"card text-center py-12",children:[(0,n.jsx)("p",{className:"text-gray-400 mb-4",children:"No donor loaded"}),(0,n.jsx)("button",{onClick:u,className:"btn btn-primary",children:"Load Next Donor"})]}),l&&(0,n.jsx)(j,{donor:l})]}),(0,n.jsxs)("div",{className:"space-y-6",children:[s&&(0,n.jsx)(d,{duration:c}),s?(0,n.jsx)(v,{onSelectOutcome:E}):(0,n.jsx)(i,{onStartCall:S,onSkip:u,disabled:!l}),(0,n.jsxs)("div",{className:"card",children:[(0,n.jsx)("h3",{className:"font-semibold mb-3",children:"Call Notes"}),(0,n.jsx)("textarea",{id:"callNotes",className:"input min-h-[100px] resize-none",placeholder:"Enter any notes from the call..."})]})]})]}),f&&(0,n.jsx)(h,{donor:l,onSubmit:L,onCancel:()=>b(!1)})]})]})}},1067:function(e,t,a){"use strict";var n=a(64090);let r=n.forwardRef(function(e,t){let{title:a,titleId:r,...o}=e;return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},o),a?n.createElement("title",{id:r},a):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))});t.Z=r},48290:function(e,t,a){"use strict";var n=a(64090);let r=n.forwardRef(function(e,t){let{title:a,titleId:r,...o}=e;return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},o),a?n.createElement("title",{id:r},a):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))});t.Z=r}},function(e){e.O(0,[508,409,837,963,505,971,69,744],function(){return e(e.s=6800)}),_N_E=e.O()}]);