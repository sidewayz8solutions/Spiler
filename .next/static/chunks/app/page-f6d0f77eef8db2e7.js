(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{89608:function(e,t,s){Promise.resolve().then(s.bind(s,30920))},30920:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return f}});var a=s(3827),l=s(64090),n=s(8792),r=s(24469),i=s(8313);function c(e){let{organizationId:t}=e,s=(0,i.useSupabase)(),[n,c]=(0,l.useState)([]);async function o(){let{data:e}=await s.from("calls").select("*").eq("organization_id",t).order("created_at",{ascending:!1}).limit(5),{data:a}=await s.from("donations").select("*").eq("organization_id",t).order("created_at",{ascending:!1}).limit(5);c([...(e||[]).map(e=>({...e,type:"call",message:"Call completed"})),...(a||[]).map(e=>({...e,type:"donation",message:"Donation: $".concat(e.amount)}))].sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime()).slice(0,10))}return(0,l.useEffect)(()=>{if(!t)return;o();let e=s.channel("activity-".concat(t)).on("postgres_changes",{event:"INSERT",schema:"public",table:"calls"},e=>{let t={...e.new,type:"call",message:"New call started",time:e.new.created_at};c(e=>[t,...e].slice(0,10))}).on("postgres_changes",{event:"INSERT",schema:"public",table:"donations"},e=>{let t=e.new,s={...e.new,type:"donation",message:"Donation received: $".concat(t.amount),time:e.new.created_at};c(e=>[s,...e].slice(0,10))}).subscribe();return()=>{s.removeChannel(e)}},[t,s]),(0,a.jsxs)("div",{className:"card h-full",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Recent Activity"}),(0,a.jsx)("div",{className:"space-y-3",children:0===n.length?(0,a.jsx)("p",{className:"text-gray-400 text-center py-8",children:"No recent activity"}):n.map((e,t)=>(0,a.jsxs)("div",{className:"flex items-start space-x-3 p-3 rounded-lg hover:bg-white/5 transition-colors",children:[(0,a.jsx)("div",{className:"\n                w-2 h-2 rounded-full mt-2\n                ".concat("donation"===e.type?"bg-green-500":"bg-blue-500","\n              ")}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"text-sm",children:e.message}),(0,a.jsx)("p",{className:"text-xs text-gray-400",children:(0,r.Q)(new Date(e.created_at||e.time||""),{addSuffix:!0})})]})]},t))})]})}var o=s(60017),d=s(57985),h=s(60463),x=s(3251),u=s(89812),m=s(48290),g=s(3478);function f(){let e=(0,i.useSupabase)(),[t,s]=(0,l.useState)({totalCalls:0,totalDonors:0,totalRaised:0,successRate:0,activeCalls:0,todaysCalls:0}),[r,f]=(0,l.useState)(!0);async function b(){try{let{data:t}=await e.from("calls").select("*"),{data:a}=await e.from("donors").select("*"),{data:l}=await e.from("donations").select("amount"),n=(null==l?void 0:l.reduce((e,t)=>e+t.amount,0))||0,r=(null==t?void 0:t.filter(e=>"donated"===e.outcome).length)||0,i=(null==t?void 0:t.length)>0?Math.round(r/t.length*100):0,c=new Date;c.setHours(0,0,0,0);let{data:o}=await e.from("calls").select("*").gte("created_at",c.toISOString());s({totalCalls:(null==t?void 0:t.length)||0,totalDonors:(null==a?void 0:a.length)||0,totalRaised:n,successRate:i,activeCalls:(null==t?void 0:t.filter(e=>"active"===e.status).length)||0,todaysCalls:(null==o?void 0:o.length)||0})}catch(e){console.error("Error loading dashboard stats:",e)}finally{f(!1)}}return(0,l.useEffect)(()=>{b()},[]),(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900",children:[(0,a.jsx)(o.Z,{}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-4xl font-bold text-white mb-2",children:"Campaign Dashboard"}),(0,a.jsx)("p",{className:"text-gray-300 text-lg",children:"Monitor your fundraising performance and manage your calling campaigns"})]}),(0,a.jsxs)("div",{className:"mb-8 flex flex-wrap gap-4",children:[(0,a.jsxs)(n.default,{href:"/dialer",className:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white font-semibold rounded-lg hover:from-green-600 hover:to-emerald-700 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105",children:[(0,a.jsx)(d.Z,{className:"w-5 h-5 mr-2"}),"Start Calling"]}),(0,a.jsxs)(n.default,{href:"/analytics",className:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-blue-500 to-indigo-600 text-white font-semibold rounded-lg hover:from-blue-600 hover:to-indigo-700 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:scale-105",children:[(0,a.jsx)(h.Z,{className:"w-5 h-5 mr-2"}),"View Analytics"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[(0,a.jsxs)("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 hover:border-green-400/50 transition-all duration-300 shadow-xl",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Active Calls"}),(0,a.jsx)(x.Z,{className:"w-8 h-8 text-green-400"})]}),(0,a.jsx)("div",{className:"text-3xl font-bold text-green-400 mb-2",children:r?"...":t.activeCalls}),(0,a.jsxs)("div",{className:"text-sm text-gray-300",children:[r?"...":t.todaysCalls," calls today"]})]}),(0,a.jsxs)("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 hover:border-blue-400/50 transition-all duration-300 shadow-xl",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Total Donors"}),(0,a.jsx)(u.Z,{className:"w-8 h-8 text-blue-400"})]}),(0,a.jsx)("div",{className:"text-3xl font-bold text-blue-400 mb-2",children:r?"...":t.totalDonors.toLocaleString()}),(0,a.jsx)("div",{className:"text-sm text-gray-300",children:"Registered donors"})]}),(0,a.jsxs)("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 hover:border-yellow-400/50 transition-all duration-300 shadow-xl",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Funds Raised"}),(0,a.jsx)(m.Z,{className:"w-8 h-8 text-yellow-400"})]}),(0,a.jsx)("div",{className:"text-3xl font-bold text-yellow-400 mb-2",children:r?"...":"$".concat(t.totalRaised.toLocaleString())}),(0,a.jsx)("div",{className:"text-sm text-gray-300",children:"Total campaign funds"})]}),(0,a.jsxs)("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 hover:border-purple-400/50 transition-all duration-300 shadow-xl",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white",children:"Success Rate"}),(0,a.jsx)(g.Z,{className:"w-8 h-8 text-purple-400"})]}),(0,a.jsx)("div",{className:"text-3xl font-bold text-purple-400 mb-2",children:r?"...":"".concat(t.successRate,"%")}),(0,a.jsx)("div",{className:"w-full bg-gray-700 rounded-full h-2",children:(0,a.jsx)("div",{className:"bg-gradient-to-r from-purple-400 to-pink-400 h-2 rounded-full transition-all duration-500",style:{width:"".concat(t.successRate,"%")}})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,a.jsx)("div",{className:"lg:col-span-2",children:(0,a.jsx)(c,{organizationId:"default"})}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 shadow-xl",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Today's Performance"}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"Calls Made"}),(0,a.jsx)("span",{className:"text-white font-semibold",children:r?"...":t.todaysCalls})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"Active Now"}),(0,a.jsx)("span",{className:"text-green-400 font-semibold",children:r?"...":t.activeCalls})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("span",{className:"text-gray-300",children:"Success Rate"}),(0,a.jsx)("span",{className:"text-purple-400 font-semibold",children:r?"...":"".concat(t.successRate,"%")})]})]})]}),(0,a.jsxs)("div",{className:"bg-white/10 backdrop-blur-lg rounded-xl p-6 border border-white/20 shadow-xl",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"Quick Actions"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(n.default,{href:"/donors",className:"block w-full text-left px-4 py-3 bg-white/10 hover:bg-white/20 rounded-lg transition-colors text-white",children:"Manage Donors"}),(0,a.jsx)(n.default,{href:"/queue",className:"block w-full text-left px-4 py-3 bg-white/10 hover:bg-white/20 rounded-lg transition-colors text-white",children:"View Call Queue"}),(0,a.jsx)(n.default,{href:"/settings",className:"block w-full text-left px-4 py-3 bg-white/10 hover:bg-white/20 rounded-lg transition-colors text-white",children:"Campaign Settings"})]})]})]})]})]})]})}},60017:function(e,t,s){"use strict";s.d(t,{Z:function(){return b}});var a=s(3827),l=s(64090),n=s(8792),r=s(47907),i=s(55138),c=s(3478),o=s(3251),d=s(53404),h=s(89812),x=s(34102),u=s(28042),m=s(58621),g=s(12360);let f=[{href:"/",label:"Dashboard",icon:c.Z},{href:"/dialer",label:"Dialer",icon:o.Z},{href:"/queue",label:"Queue",icon:d.Z},{href:"/donors",label:"Donors",icon:h.Z},{href:"/analytics",label:"Analytics",icon:c.Z},{href:"/settings",label:"Settings",icon:x.Z}];function b(){let e=(0,r.usePathname)(),{user:t,signOut:s}=(0,i.a)(),[c,o]=(0,l.useState)(!1);return(0,a.jsxs)("nav",{className:"bg-spiler-dark/50 backdrop-blur-lg border-b border-indigo-500/10 sticky top-0 z-50",children:[(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,a.jsxs)(n.default,{href:"/",className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"text-2xl",children:"\uD83D\uDCDE"}),(0,a.jsx)("span",{className:"text-xl font-bold text-gradient",children:"Spiler"})]}),(0,a.jsx)("div",{className:"hidden md:flex items-center space-x-1",children:f.map(t=>{let s=t.icon,l=e===t.href;return(0,a.jsxs)(n.default,{href:t.href,className:"\n                    flex items-center space-x-2 px-4 py-2 rounded-lg transition-all\n                    ".concat(l?"bg-indigo-500/20 text-indigo-400":"text-gray-400 hover:text-white hover:bg-white/5","\n                  "),children:[(0,a.jsx)(s,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:t.label})]},t.href)})}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"hidden md:flex items-center space-x-3",children:[(0,a.jsx)("span",{className:"text-sm text-gray-400",children:null==t?void 0:t.email}),(0,a.jsx)("button",{onClick:s,className:"p-2 text-gray-400 hover:text-white transition-colors",title:"Sign out",children:(0,a.jsx)(u.Z,{className:"w-5 h-5"})})]}),(0,a.jsx)("button",{onClick:()=>o(!c),className:"md:hidden p-2 text-gray-400 hover:text-white",children:c?(0,a.jsx)(m.Z,{className:"w-6 h-6"}):(0,a.jsx)(g.Z,{className:"w-6 h-6"})})]})]})}),c&&(0,a.jsx)("div",{className:"md:hidden bg-spiler-dark border-t border-indigo-500/10",children:(0,a.jsxs)("div",{className:"px-4 py-4 space-y-2",children:[f.map(t=>{let s=t.icon,l=e===t.href;return(0,a.jsxs)(n.default,{href:t.href,onClick:()=>o(!1),className:"\n                    flex items-center space-x-3 px-4 py-3 rounded-lg transition-all\n                    ".concat(l?"bg-indigo-500/20 text-indigo-400":"text-gray-400 hover:text-white hover:bg-white/5","\n                  "),children:[(0,a.jsx)(s,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:t.label})]},t.href)}),(0,a.jsxs)("button",{onClick:s,className:"flex items-center space-x-3 px-4 py-3 text-red-400 hover:bg-red-500/10 rounded-lg w-full",children:[(0,a.jsx)(u.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"Sign Out"})]})]})})]})}},8313:function(e,t,s){"use strict";s.r(t),s.d(t,{Providers:function(){return h},SupabaseContext:function(){return d},useSupabase:function(){return x}});var a=s(3827),l=s(64090),n=s(47907),r=s(58714),i=s(52688),c=s(47082);let o=new i.S,d=(0,l.createContext)(null);function h(e){let{children:t}=e,[s]=(0,l.useState)(()=>(0,r.createClientComponentClient)()),i=(0,n.useRouter)();return(0,l.useEffect)(()=>{let{data:{subscription:e}}=s.auth.onAuthStateChange(e=>{"SIGNED_OUT"===e&&i.push("/auth/login")});return()=>{e.unsubscribe()}},[s,i]),(0,a.jsx)(d.Provider,{value:s,children:(0,a.jsx)(c.aH,{client:o,children:t})})}let x=()=>{let e=(0,l.useContext)(d);if(!e)throw Error("useSupabase must be used within SupabaseProvider");return e}},55138:function(e,t,s){"use strict";s.d(t,{a:function(){return c}});var a=s(64090),l=s(8313),n=s(22020),r=s(65249);let i=(0,n.Ue)((0,r.tJ)(e=>({user:null,organization:null,teamMember:null,setUser:t=>e({user:t}),setOrganization:t=>e({organization:t}),setTeamMember:t=>e({teamMember:t}),reset:()=>e({user:null,organization:null,teamMember:null})}),{name:"spiler-auth"}));function c(){let e=(0,l.useSupabase)(),{user:t,organization:s,teamMember:n,setUser:r,setOrganization:c,setTeamMember:o,reset:d}=i(),[h,x]=(0,a.useState)(!0);async function u(){try{let{data:{user:t}}=await e.auth.getUser();if(t){r(t);let{data:s}=await e.from("team_members").select("\n            *,\n            organization:organizations(*)\n          ").eq("user_id",t.id).single();s&&(o(s),c(s.organization))}}catch(e){console.error("Error loading user:",e)}finally{x(!1)}}return(0,a.useEffect)(()=>{u();let{data:{subscription:t}}=e.auth.onAuthStateChange(async(e,t)=>{t?await u():d()});return()=>t.unsubscribe()},[]),{user:t,organization:s,teamMember:n,loading:h,signIn:async function(t,s){let{data:a,error:l}=await e.auth.signInWithPassword({email:t,password:s});if(l)throw l;return a},signUp:async function(t,s){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{data:l,error:n}=await e.auth.signUp({email:t,password:s,options:{data:a}});if(n)throw n;return l},signOut:async function(){let{error:t}=await e.auth.signOut();if(t)throw t;d()}}}}},function(e){e.O(0,[508,409,51,971,69,744],function(){return e(e.s=89608)}),_N_E=e.O()}]);